import pandas as pd
import argparse
import time

if __name__ == "__main__":

	parser = argparse.ArgumentParser(description = "Nearest neighbor search technique on grid-indexed data")

	parser.add_argument('-x', type=float, help = "latitude of query location q", required=True)
	parser.add_argument('-y', type=float, help = "longitude of query location q", required=True)
	parser.add_argument('-k', type=int, help = "integer k", required=True)

	args = parser.parse_args()

	df = pd.read_csv('Gowalla_totalCheckins.txt', sep="\t", header=None)

	df.columns = ["user", "check-in time", "latitude", "longitude", "location id"]

	TargetSet = []

	start = time.time()
	for index, row in df.iterrows():
			if len(TargetSet) < args.k:
				TargetSet.append(index)
				TargetSet.reverse()
				t = TargetSet[0]
			else:
				if (row['latitude'] - args.x)**2 + (row['longitude'] - args.y)**2 < t:
					TargetSet.remove(t)
					TargetSet.append(index)
					TargetSet.reverse()
					t = TargetSet[0]

	end = time.time()
	elapsed = end - start
	
